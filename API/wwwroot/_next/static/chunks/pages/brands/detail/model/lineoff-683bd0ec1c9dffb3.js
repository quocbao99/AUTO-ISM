(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[269],{32577:function(e,i,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/brands/detail/model/lineoff",function(){return n(95175)}])},95175:function(e,i,n){"use strict";n.r(i),n.d(i,{default:function(){return R}});var t=n(85893),l=n(62097),a=n(61225),s=n(85214),o=n(95309),d=n(61702),r=n(29630),c=n(30120),u=n(26993),h=n(64489),x=n(79072),m=n(44373),p=n(11163),g=n(87536),f=n(51964),j=n.n(f),y=n(88767),v=n(46050),b=n(73762),Z=n(51482),I=n(37024),C=n(31812),w=n(86010),F=n(25675),S=n.n(F),T=n(41664),D=n.n(T),O=n(67294),M=n(51593),L=n(76429),k=n(21977),P=n(13136),N=n(17575),q=n(80562),H=n(91655),A=n(65824);const Q=e=>{let{}=e;const i=(0,p.useRouter)(),n=(0,l.Z)(),a=(0,y.useQueryClient)(),s=(0,I.q)(),o=(0,I.q)(),d=i.query.brandId,h=i.query.modelId,m=i.query.lineoffId,f=(0,O.useRef)([]),[j,v]=(0,O.useState)((()=>localStorage.getItem("lineOffLayout")?String(localStorage.getItem("lineOffLayout")):"cards")),{reset:b,control:C,watch:w,handleSubmit:F,setValue:S}=(0,g.cI)({defaultValues:{pageSize:4,pageIndex:1,searchContent:"",systemFileCategory:""}}),T=w(),D=e=>{b({...e,systemFileCategory:T.systemFileCategory})},Q=(e,i)=>{S("pageIndex",i)},B=(0,y.useMutation)((e=>Promise.all(e.map((e=>M.xl.delete(e))))),{onSuccess:e=>{a.invalidateQueries(["foldersLineoffQuery",m]),o.onClose(),k.dN.success("X\xf3a th\xe0nh c\xf4ng")},onError:e=>{k.dN.error(e)}}),{data:_,isLoading:R,isFetching:W}=(0,y.useQuery)(["foldersLineoffQuery",m,T.systemFileCategory,T.pageIndex,T.pageSize],(()=>m?M.xl.getAll({...T,LineOffID:m,systemFileCategory:T.systemFileCategory}):void 0),{enabled:!!m,keepPreviousData:!0,refetchOnWindowFocus:!1}),E=(0,O.useMemo)((()=>(null===_||void 0===_?void 0:_.data.items)||[]),[null===_||void 0===_?void 0:_.data]),z=e=>{switch(e.systemFileCategory){case"1":return(0,t.jsx)(t.Fragment,{children:"Wiring Diagram"});case"2":return(0,t.jsx)(t.Fragment,{children:"Specifications"});case"3":return(0,t.jsx)(t.Fragment,{children:"Timing Belt/Chain"});case"4":return(0,t.jsx)(t.Fragment,{children:"Trouble Shooting Guide"});case"5":return(0,t.jsx)(t.Fragment,{children:"Transmission Manual"})}},X=(0,O.useMemo)((()=>[{Header:"T\xean folder",accessor:"name"},{Header:"Lo\u1ea1i t\xe0i li\u1ec7u",accessor:"systemFileCategory",Cell:e=>{let{row:i}=e;return(0,t.jsx)(t.Fragment,{children:z(i.original)})}},{Header:"S\u1ed1 folders con",accessor:"countChildFile",align:"right"},{Header:"H\xe0nh \u0111\u1ed9ng ",accessor:"id",align:"center",minWidth:150,Cell:e=>{let{row:l}=e;return(0,t.jsx)(N.Z,{title:"\u0110i t\u1edbi chi ti\u1ebft folder",children:(0,t.jsx)(q.Z,{sx:{" svg":{width:"20px",height:"20px"},fill:n.palette.primary.main},onClick:()=>{i.push({pathname:"/brands/detail/model/lineoff/systemfile",query:{brandId:d,modelId:h,lineoffId:m,systemFileId:l.original.id}})},children:(0,t.jsx)(Z.Nw,{})})})}}]),[]);return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)(c.Z,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:"36px"},children:[(0,t.jsx)(r.Z,{variant:"largeTitle",children:"All Folders"}),(0,t.jsx)(L.HS,{title:"T\u1ea1o folder file system",disabled:!m,handleFunction:s.onOpen})]}),(0,t.jsxs)(c.Z,{sx:{mb:"36px",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,t.jsx)(c.Z,{sx:{maxWidth:"300px"},children:(0,t.jsx)(L.o,{placeholder:"Ch\u1ecdn lo\u1ea1i t\xe0i li\u1ec7u",isClearable:!0,options:[{value:"1",label:"Wiring Diagram"},{value:"2",label:"Specifications"},{value:"3",label:"Timing Belt/Chain"},{value:"4",label:"Trouble Shooting Guide"},{value:"5",label:"Transmission Manual"}],getOptionLabel:e=>e.label,getOptionValue:e=>e.value,control:C,name:"systemFileCategory"})}),(0,t.jsx)(c.Z,{children:(0,t.jsx)(P.Mf,{layout:j,handleSetLayout:e=>{"cards"==e?(v(e),S("pageSize",4),S("pageIndex",1)):(v(e),S("pageSize",10)),localStorage.setItem("lineOffLayout",e)}})})]}),"cards"==j?R||W?(0,t.jsxs)(x.ZP,{container:!0,spacing:"27px",children:[(0,t.jsx)(x.ZP,{item:!0,sm:12,xl:6,children:(0,t.jsx)(H.Z,{variant:"rectangular",width:"100%",height:90})}),(0,t.jsx)(x.ZP,{item:!0,sm:12,xl:6,children:(0,t.jsx)(H.Z,{variant:"rectangular",width:"100%",height:90})}),(0,t.jsx)(x.ZP,{item:!0,sm:12,xl:6,children:(0,t.jsx)(H.Z,{variant:"rectangular",width:"100%",height:90})}),(0,t.jsx)(x.ZP,{item:!0,sm:12,xl:6,children:(0,t.jsx)(H.Z,{variant:"rectangular",width:"100%",height:90})})]}):(null===_||void 0===_?void 0:_.data.items.length)?(0,t.jsxs)(c.Z,{children:[(0,t.jsx)(x.ZP,{container:!0,spacing:"27px",children:_.data.items.map(((e,n)=>(0,t.jsx)(x.ZP,{item:!0,sm:12,xl:6,children:(0,t.jsx)(P.Ac,{data:e,handleClick:()=>{i.push({pathname:"/brands/detail/model/lineoff/systemfile",query:{brandId:d,modelId:h,lineoffId:m,systemFileId:e.id}})},title:e.name||"noname",numberFiles:e.countChildFile||0})},"FolderCard-".concat(n))))}),(0,t.jsx)(c.Z,{sx:{mt:"27px",width:"100%",display:"flex",justifyContent:"center"},children:(0,t.jsx)(A.Z,{page:T.pageIndex,sx:{"& .Mui-selected":{boxShadow:"rgb(243 133 89 / 25%) 0px 1px 4px, rgb(243 133 89 / 35%) 0px 3px 12px 2px"},"& .MuiButtonBase-root":{fontWeight:600}},onChange:Q,color:"primary",count:_.data.totalPage})})]}):(0,t.jsx)(t.Fragment,{children:(0,t.jsx)(r.Z,{fontStyle:"italic",variant:"subtitle2",children:"Kh\xf4ng t\xecm th\u1ea5y d\u1eef li\u1ec7u"})}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(L.ZD,{viewProps:{},data:E,totalRows:(null===_||void 0===_?void 0:_.data.totalItem)||0,totalPage:(null===_||void 0===_?void 0:_.data.totalPage)||0,multiSelectAction:e=>(0,t.jsx)("div",{children:(0,t.jsx)(u.Z,{onClick:()=>{f.current=e,o.onOpen()},color:"error",children:"Delete"})}),tableOptions:{columns:X},onRefetchQuery:()=>{},isToggleHiddenColumn:!0,tablePlugins:["globalFilter","pagination","rowSelect"],searchState:T,setNewState:D,isLoading:R||W}),(0,t.jsx)(P.AN,{handleFunction:()=>{var e;B.mutateAsync(null===(e=f.current)||void 0===e?void 0:e.map((e=>e.id)))},title:"X\xd3A FOLDER T\xc0I LI\u1ec6U",content:"B\u1ea1n c\xf3 ch\u1eafc mu\u1ed1n x\xf3a c\xe1c folders \u0111\xe3 ch\u1ecdn? H\xe0nh \u0111\u1ed9ng n\xe0y kh\xf4ng th\u1ec3 ho\xe0n t\xe1c \u0111\u01b0\u1ee3c",isOpen:o.isOpen,onClose:o.onClose})]}),(0,t.jsx)(P.S$,{systemFileType:1,isOpen:s.isOpen,onClose:s.onClose,lineOffId:m,dataUpdate:null})]})},B=e=>{let{}=e;const i=(0,p.useRouter)(),n=(0,y.useQueryClient)(),{classes:f}=_(),v=(0,I.q)(),b=(0,l.Z)(),F=(0,a.Z)(b.breakpoints.down(1250)),T=i.query.brandId,N=(i.query.modelId,i.query.lineoffId),q=(0,g.cI)({defaultValues:{id:"",name:"",year:null,myTemporaryYear:null}}),H=q.watch(),{data:A}=(0,y.useQuery)(["brandDetail",T],(()=>T?M.Dd.getById(T):void 0),{enabled:!!T,refetchOnWindowFocus:!1,staleTime:1/0}),{data:B,isFetching:R}=(0,y.useQuery)(["lineoffDetailQuery",N],(()=>N?M.TZ.getById(N):void 0),{onSuccess:e=>{console.log(e)},enabled:!!N,refetchOnWindowFocus:!1}),{data:W,isLoading:E,isFetching:z}=(0,y.useQuery)(["lineoffQuery",null===B||void 0===B?void 0:B.data.eModelID],(()=>(null===B||void 0===B?void 0:B.data.eModelID)?M.TZ.getAll({pageIndex:1,pageSize:50,emodelID:null===B||void 0===B?void 0:B.data.eModelID}):void 0),{enabled:!!(null===B||void 0===B?void 0:B.data.eModelID),refetchOnWindowFocus:!1,keepPreviousData:!0});(0,O.useEffect)((()=>{(null===B||void 0===B?void 0:B.data)&&q.reset({...B.data,myTemporaryYear:new Date("01-01-".concat(B.data.year)).getTime()/1e3})}),[null===B||void 0===B?void 0:B.data]);const X=(0,y.useMutation)(M.TZ.update,{onSuccess:e=>{n.invalidateQueries(["lineoffDetailQuery",N]),n.invalidateQueries(["lineoffQuery",null===B||void 0===B?void 0:B.data.eModelID]),k.dN.success("C\u1eadp nh\u1eadt line-off th\xe0nh c\xf4ng")}}),U=(0,y.useMutation)(M.aq.upload);return(0,t.jsx)(c.Z,{sx:{minHeight:"calc(100vh - 300px)"},children:(0,t.jsxs)(c.Z,{sx:{width:"100%",display:"flex",gap:F?0:"36px"},children:[(0,t.jsx)(c.Z,{sx:{width:"calc(100%)",maxWidth:"1226px",margin:"0 auto"},children:(0,t.jsx)(c.Z,{sx:{width:"100%",display:"flex"},children:(0,t.jsxs)(c.Z,{sx:{width:"100%",margin:"0 auto"},children:[(0,t.jsxs)(c.Z,{className:"flex items-center",children:[(0,t.jsx)(L.qI,{title:"Tr\u1edf l\u1ea1i",onClick1:()=>{i.push({pathname:"/brands/detail/model",query:{brandId:T,modelId:null===B||void 0===B?void 0:B.data.eModelID}})},sx:{marginRight:"18px"},children:(0,t.jsx)(Z.Ii,{})}),(0,t.jsxs)(c.Z,{sx:{flex:1},children:[(0,t.jsxs)(r.Z,{variant:"largeTitle",children:[null===B||void 0===B?void 0:B.data.eModelName," - ",null===B||void 0===B?void 0:B.data.name]}),(0,t.jsx)(c.Z,{children:(0,t.jsxs)(h.Z,{maxItems:2,"aria-label":"breadcrumb",children:[(0,t.jsx)(D(),{href:"/",passHref:!0,children:"Home"}),(0,t.jsx)(D(),{href:"/brands",passHref:!0,children:"Brands"}),(0,t.jsxs)(D(),{href:"/brands/detail/?brandId=".concat(T),passHref:!0,children:["Brand ",null===A||void 0===A?void 0:A.data.code]}),(0,t.jsxs)(D(),{href:"/brands/detail/model/?brandId=".concat(T,"&modelId=").concat(null===B||void 0===B?void 0:B.data.eModelID),passHref:!0,children:["Model ",null===B||void 0===B?void 0:B.data.eModelName]}),(0,t.jsxs)(r.Z,{color:"text.dark",children:["line-off ",null===B||void 0===B?void 0:B.data.name]})]})})]})]}),(0,t.jsx)(c.Z,{sx:{py:"36px"},children:(0,t.jsx)(L.AX,{children:(0,t.jsx)("form",{onSubmit:q.handleSubmit((e=>{console.log(e),X.mutateAsync(e)}),(e=>{(0,k.lQ)(e)})),children:(0,t.jsx)(c.Z,{children:(0,t.jsxs)(x.ZP,{container:!0,sx:{},children:[(0,t.jsx)(x.ZP,{item:!0,xs:12,md:4,sx:{borderRight:F?"":"thin solid rgba(0, 0, 0, 0.12)",p:"27px"},children:(0,t.jsxs)(c.Z,{className:"flex flex-col items-center",sx:{height:"100%"},children:[(0,t.jsx)(c.Z,{sx:{position:"relative",width:"100%",height:"100%",minHeight:"180px"," img":{objectFit:"contain"},mb:"16px"},onClick:()=>{console.log(H.icon)},children:(0,t.jsx)(S(),{fill:!0,src:H.icon||"https://via.placeholder.com/150",alt:"brand-image"})}),(0,t.jsxs)("label",{htmlFor:"update_avatarLineOff",children:[(0,t.jsx)("input",{type:"file",accept:"image/*",id:"update_avatarLineOff",style:{display:"none"},onChange:async e=>{await U.mutateAsync(e.currentTarget.files[0],{onSuccess:e=>{e&&(console.log(e),q.setValue("icon",e.fileUrl,{shouldDirty:!0}))},onError:e=>{console.log(e)}})}}),(0,t.jsx)(C.Z,{size:"large",startIcon:(0,t.jsx)(Z.eD,{}),sx:{bgcolor:"#f385591a",gap:"6px",fill:b.palette.primary.dark,padding:"14px 42px",color:b.palette.primary.dark},variant:"text",component:"span",loading:U.isLoading,children:"Ch\u1ecdn \u1ea3nh"})]})]})}),(0,t.jsx)(x.ZP,{item:!0,xs:12,md:8,sx:{p:"27px"},children:(0,t.jsxs)(c.Z,{className:"flex flex-col justify-between h-full",children:[(0,t.jsxs)(c.Z,{children:[(0,t.jsx)(r.Z,{variant:"h3",sx:{opacity:.4,mb:"27px"},children:"TH\xd4NG TIN CHI TI\u1ebeT"}),(0,t.jsx)(c.Z,{children:(0,t.jsxs)(x.ZP,{container:!0,spacing:"27px",children:[(0,t.jsx)(x.ZP,{item:!0,xs:12,children:(0,t.jsx)(L.Zd,{control:q.control,name:"myTemporaryYear",label:"N\u0102M",required:!0,readOnly:!0,views:["year"]})}),(0,t.jsx)(x.ZP,{item:!0,xs:12,children:(0,t.jsx)(L.qR,{control:q.control,name:"name",label:"TI\xcaU \u0110\u1ec0",required:!0})})]})})]}),(0,t.jsxs)(c.Z,{children:[(0,t.jsx)(m.Z,{}),(0,t.jsx)(c.Z,{sx:{display:"flex",justifyContent:"flex-end",pt:"27px"},children:(0,t.jsx)(C.Z,{variant:"contained",loading:X.isLoading,type:"submit",disabled:!q.formState.isDirty,children:"L\u01b0u"})})]})]})})]})})})})}),(0,t.jsx)(c.Z,{sx:{},children:(0,t.jsx)(Q,{})})]})})}),(0,t.jsx)(c.Z,{sx:{position:"sticky",width:F?0:"265px",top:88,right:0,height:"calc(100vh - 373px)"},children:(0,t.jsxs)(L.AX,{title:"C\xe1c Line-off c\u1ee7a ".concat(null===B||void 0===B?void 0:B.data.eModelName),children:[(0,t.jsx)(c.Z,{children:(0,t.jsxs)(j(),{style:{display:"block",overflow:"hidden",touchAction:"auto",overflowAnchor:"none",height:"calc(100vh - 373px)",position:"relative",paddingLeft:"8px",paddingRight:"8px",paddingTop:"0",paddingBottom:0},children:[(0,t.jsx)(s.Z,{children:(null===W||void 0===W?void 0:W.data.items.length)?W.data.items.map(((e,n)=>{const l=e.id==N;return(0,t.jsx)(o.Z,{className:(0,w.Z)(f.listItem,{[f.listItemActive]:l}),sx:{},onClick:()=>{l||i.replace({pathname:"/brands/detail/model/lineoff",query:{brandId:T,modelId:null===B||void 0===B?void 0:B.data.eModelID,lineoffId:e.id}})},children:(0,t.jsx)(d.Z,{primary:(0,t.jsx)(r.Z,{color:"inherit",children:e.name})})},"modelsOfBrand-".concat(n))})):null}),(0,t.jsx)(c.Z,{sx:{p:"12px"},children:(0,t.jsx)(u.Z,{onClick:()=>{v.onOpen()},sx:{"& .MuiButton-startIcon":{fill:"#ef5d22"}},size:"small",variant:"outlined",startIcon:(0,t.jsx)(Z.qJ,{}),children:"T\u1ea1o m\u1edbi line-off"})})]})}),(0,t.jsx)(P.H$,{isOpen:v.isOpen,onClose:v.onClose,dataUpdate:null,eModelID:null===B||void 0===B?void 0:B.data.eModelID})]})})]})})};B.title="Chi ti\u1ebft line-off",B.getLayout=e=>(0,t.jsx)(b.Z,{children:e});const _=(0,v.ZL)()((e=>({listItem:{"&.MuiListItemButton-root":{"&:hover":{backgroundColor:"rgba(0, 0, 0, 0.03)"}}," p":{transition:e.transitions.create(["padding","width"],{easing:e.transitions.easing.easeOut,duration:e.transitions.duration.enteringScreen})}},listItemActive:{"&.MuiListItemButton-root":{backgroundColor:e.palette.primary.light,"&:hover":{backgroundColor:e.palette.primary.light}}," p":{fontWeight:600,color:e.palette.primary.dark,paddingLeft:"12px"}},iconDot:{marginLeft:"6px",width:"6px",height:"6px",backgroundColor:"#626262",borderRadius:"50px"},iconDotActive:{backgroundColor:e.palette.primary.main}})));var R=B}},function(e){e.O(0,[587,109,491,211,412,250,59,29,136,774,888,179],(function(){return i=32577,e(e.s=i);var i}));var i=e.O();_N_E=i}]);